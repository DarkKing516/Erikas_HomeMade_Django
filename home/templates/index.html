{% extends 'layouts/navbar.html' %}
{% load static %}
{% block content %}
<style>
  html {
    scroll-behavior: smooth;
  }

  .container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
  }

  .reserva-table {
    width: 100%;
    border-collapse: collapse;
  }

  .reserva-table th,
  .reserva-table td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
  }

  .reserva-table th {
    background-color: #f2f2f2;
  }

  .btn {
    display: inline-block;
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    text-decoration: none;
    color: #fff;
  }

  .btn-primary {
    background-color: #007bff;
  }

  .btn-info {
    background-color: #17a2b8;
  }

  .btn-danger {
    background-color: #dc3545;
  }

  .hero {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    width: 100%;
    padding: 2rem;
    box-sizing: border-box;
    position: relative;
    color: white;
    text-align: left;
    z-index: 1;
    margin-bottom: 2rem; /* Añadir margen inferior */
  }
  .hero-servicios {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    width: 100%;
    padding: 2rem;
    box-sizing: border-box;
    position: relative;
    color: black;
    text-align: left;
    z-index: 1;
    margin-bottom: 2rem; /* Añadir margen inferior */
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='100' viewBox='0 0 200 100'%3E%3Cpath fill='%23CEF2EA' d='M0 30 Q 20 0 40 30 T 80 30 Q 100 60 120 30 T 160 30 Q 180 0 200 30 V 100 H 0 Z' /%3E%3C/svg%3E");
    background-size: cover; /* Ajuste para cubrir completamente el área sin repetir */
    background-repeat: no-repeat;
}

  .hero-background {
    background-image: url('{% static "images/fondoindex.jpeg" %}');
    background-size: cover; /* Para cubrir toda el área */
    background-position: center; /* Centrar la imagen */
    background-repeat: no-repeat; /* Evitar que la imagen se repita */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh; /* Altura completa de la ventana */
    position: relative; /* Agregado */
  }

  
  .hero-left, .hero-right {
    flex: 1;
    padding: 1rem;
  }

  .hero-right {
    padding-left: 2rem;
  }

  .hero h1 {
    font-size: 4rem;
    margin-bottom: 1rem;
  }

  .hero p {
    font-size: 1.125rem;
    line-height: 1.5;
    max-width: 800px;
    margin: 0 auto;
  }

  .hero:nth-child(1) {
    background-color: #f8f9fa;
  }

  .hero:nth-child(2) {
    background-color: #e9ecef;
  }

  .hero:nth-child(3) {
    background-color: #dee2e6;
  }

  .hero:nth-child(4) {
    background-color: #ced4da;
  }

  .hero:nth-child(5) {
    background-color: #adb5bd;
  }

  .hero img {
    width: 100%;
    max-width: 300px;
    display: block;
    margin: 0 auto;
  }

  .hero ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .hero li {
    margin-bottom: 0.5rem;
  }

  /* Estilos para las ondas */
  .wave {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%; /* Cambiado */
    height: 100px; /* Ajusta la altura de las ondas */
    background-image: linear-gradient(to right, #ffffff 0%, #ffffff 50%, #f0f0f0 50%, #f0f0f0 100%);
  }
</style>


<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">


<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
<!-- <link rel="stylesheet" href="{% static 'css/fonts.css' %}"> -->
<!-- <link rel="stylesheet" href="{% static 'css/style.css' %}"> -->
<!-- CSS de la v0.dev IA god -->
<!-- <link rel="stylesheet" href="{% static 'css/tailwind.css' %}"> -->
<style>
  .hero-background {
    position: relative; /* Importante para que el pseudo-elemento funcione correctamente */
    height: 100vh; /* Altura completa de la ventana */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background-image: url('{% static "images/fondoindex.jpeg" %}');
    background-size: cover; /* Para cubrir toda el área */
    background-position: center; /* Centrar la imagen */
    background-repeat: no-repeat; /* Evitar que la imagen se repita */
    z-index: 0;
}

.hero-background::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5); /* Añadir un overlay oscuro */
    z-index: -1; /* Asegurarse de que esté detrás del contenido */
    backdrop-filter: blur(5px); /* Aplicar desenfoque */
}

.hero {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: 2rem;
    box-sizing: border-box;
    color: white;
    text-align: center;
    z-index: 1;
    margin-bottom: 2rem; /* Añadir margen inferior */
}

.hero h1 {
    font-size: 3rem; /* Tamaño del título */
    font-family: 'Arial', sans-serif; /* Fuente del título */
    color: #FFD700; /* Color amarillo para destacar el título */
    margin-bottom: 1rem;
}

.hero p {
    font-size: 1.5rem; /* Tamaño de la descripción */
    font-family: 'Arial', sans-serif; /* Fuente de la descripción */
    color: white; /* Color blanco */
    max-width: 800px; /* Limitar el ancho del texto para mejor legibilidad */
    margin: 0 auto;
    text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.7); /* Añadir sombra al texto para mejor contraste */
}

</style>

<!--
// v0 by Vercel.
// https://v0.dev/t/7Gsr2v1W3Lp
-->

<center>
  <section class="hero-section">
    <div class="hero-container">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">Erika's HomeMade</h1>
          <p class="hero-description">
            Taller de costura y arreglos de moda. Creamos prendas a medida y ofrecemos servicios de reparación y personalización de ropa.
          </p>
        </div>
        <div class="hero-buttons">
          <a class="btn primary-btn" href="#uwuNOsotros" rel="ugc">Conoce más</a>
          <!-- <a class="btn secondary-btn" href="#" rel="ugc">Contac to</a> -->
        </div>
      </div>
      <img class="hero-image" src="https://img.freepik.com/vector-premium/taller-costura-disenadores-fondo-maquina-coser_273625-128.jpg" width="550" height="310" alt="Hero" />
    </div>
  </section>
</center>

<style>
body {
  font-family: 'Arial', sans-serif;
  margin: 0;
  padding: 0;
}

.hero-section {
  width: 100%;
  padding: 3rem 0;
}

.hero-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0 1rem;
}

.hero-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  margin-bottom: 2rem;
}

.hero-text {
  margin-bottom: 1rem;
}

.hero-title {
  font-size: 2rem;
  font-weight: bold;
  margin: 0 0 1rem 0;
}

.hero-description {
  max-width: 600px;
  color: #6b7280;
  font-size: 1rem;
  line-height: 1.5;
}

.hero-buttons {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.hero-buttons .btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 2.5rem;
  padding: 0 2rem;
  font-size: 0.875rem;
  font-weight: medium;
  border-radius: 0.375rem;
  transition: background-color 0.3s, color 0.3s;
  text-decoration: none;
}

.primary-btn {
  background-color: #111827;
  color: #f9fafb;
}

.primary-btn:hover {
  background-color: #1f2937;
}

.secondary-btn {
  border: 1px solid #e5e7eb;
  background-color: #fff;
  color: #111827;
}

.secondary-btn:hover {
  background-color: #f3f4f6;
}

.hero-image {
  max-width: 100%;
  border-radius: 0.75rem;
  object-fit: cover;
  object-position: center;
}

</style>

<!-- <div class="hero hero-background">
  <center>
    <h1>Bienvenidos a Erika's HomeMade</h1>
  </center>
  <p>En Erika's HomeMade, nos especializamos en confección a medida, ofreciendo diseños exclusivos y personalizados para cada cliente. Nuestra pasión es crear piezas únicas que realcen tu estilo y personalidad.</p>
</div> -->

<!--
// v0 by Vercel.
// https://v0.dev/t/xDrF7U2dpDT
-->

<!-- <section id="uwuNOsotros" class="w-full py-12 md:py-24 lg:py-32">
  <div class="container grid gap-10 px-4 md:grid-cols-2 md:gap-16 md:px-6">
    <div>
      <h2 class="text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl">Acerca de Nosotros</h2>
      <p class="mt-4 text-gray-500 md:text-xl dark:text-gray-400">
        Somos una empresa dedicada a la confección de prendas de vestir de alta calidad. Nos enorgullecemos de
        ofrecer un servicio personalizado y atención al detalle en cada uno de nuestros productos. Nuestro equipo de
        diseñadores y sastres expertos trabajan arduamente para crear piezas únicas que se ajusten perfectamente a
        las necesidades de nuestros clientes.
      </p>
    </div>
    <div>
      <h2 class="text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl">Servicios</h2>
      <ul class="mt-4 space-y-2 text-gray-500 md:text-xl dark:text-gray-400">
        <li class="flex items-center gap-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="h-5 w-5 fill-primary"
          >
            <path d="M20 6 9 17l-5-5"></path>
          </svg>
          Confección a medida
        </li>
        <li class="flex items-center gap-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="h-5 w-5 fill-primary"
          >
            <path d="M20 6 9 17l-5-5"></path>
          </svg>
          Arreglos y ajustes
        </li>
        <li class="flex items-center gap-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="h-5 w-5 fill-primary"
          >
            <path d="M20 6 9 17l-5-5"></path>
          </svg>
          Diseño de moda
        </li>
      </ul>
    </div>
  </div>
</section> -->


<div id="uwuNOsotros" class="hero-servicios">
  <div class="hero-left">
    <h3>Acerca de Nosotros</h3>
    <p>En Erika's HomeMade, combinamos tradición y modernidad para crear prendas a medida que son tanto elegantes como cómodas. Desde nuestro inicio, hemos trabajado con dedicación para ofrecer una experiencia de confección personalizada y de alta calidad.</p>
  </div>
  <div class="hero-right">
    <h3>Servicios</h3>
    <ul>
      <li>Confección a medida: Trajes, vestidos y prendas personalizadas hechas a tu medida exacta.</li>
      <li>Arreglos y ajustes: Modificaciones y ajustes para que tu ropa se ajuste perfectamente.</li>
      <li>Diseño de moda: Asesoramiento y creación de diseños exclusivos para eventos especiales.</li>
    </ul>
  </div>
</div>



<section class="section section-last bg-default">
  <div class="container-fluidd container-inset-0 isotope-wrap">
    <div class="row row-10 gutters-10 isotope" data-isotope-layout="masonry" data-isotope-group="gallery" data-lightgallery="group">
      <br>
      {% for producto, tamano, clase in productos_tamanos %}
      <div class="{{ clase.class }}">
          <!-- Thumbnail Mary-->
          <article class="{{ clase.hijo }}">
              <a class="thumbnail-mary-figure" href="{% url 'home:catalogo' %}" data-lightgallery="item">
                {% if producto.imagen %}
                  <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="{{ tamano }}"/>
                {% else %}
                  <img src="/media/user_images/imagendefectoNoBorrar.gif" alt="{{ producto.nombre }}" class="{{ tamano }}"/>
                {% endif %}
              </a>
              <div class="thumbnail-mary-caption">
                  <div>
                      <h6 class="thumbnail-mary-title"><a href="{% url 'home:catalogo' %}">{{ producto.nombre }}</a></h6>
                      <div class="thumbnail-mary-location">{{ producto.descripcion }}</div>
                  </div>
              </div>
          </article>
      </div>
      {% endfor %}
      
      
    </div>
  </div>
</section>

<!-- Section Services  Last section-->
<section class="section section-sm bg-default">
  <div class="container">
    <div class="owl-carousel owl-style-11 dots-style-2" data-items="1" data-sm-items="1" data-lg-items="2" data-xl-items="4" data-margin="30" data-dots="true" data-mouse-drag="true" data-rtl="true">
      <article class="box-icon-megan wow fadeInUp">
        <div class="box-icon-megan-header">
          <center>
            <div class="box-icon-megan-icon">
              <i class="bi bi-scissors"></i>
            </div>
          </center>
        </div>
        <h5 class="box-icon-megan-title"><a href="#">Arreglos de Ropa</a></h5>
        <p class="box-icon-megan-text">Ofrecemos arreglos profesionales para todo tipo de prendas.</p>
      </article>
      <article class="box-icon-megan wow fadeInUp" data-wow-delay=".05s">
        <div class="box-icon-megan-header">
          <center>
            <div class="box-icon-megan-icon">
              <i class="bi bi-rulers"></i>
            </div>
          </center>
        </div>
        <h5 class="box-icon-megan-title"><a href="#">Ropa a la Medida</a></h5>
        <p class="box-icon-megan-text">Diseñamos y confeccionamos ropa a la medida según tus necesidades.</p>
      </article>
      <article class="box-icon-megan wow fadeInUp" data-wow-delay=".1s">
        <div class="box-icon-megan-header">
          <center>
            <div class="box-icon-megan-icon">
              <i class="bi bi-palette"></i>
            </div>
          </center>
        </div>
        <h5 class="box-icon-megan-title"><a href="#">Manualidades</a></h5>
        <p class="box-icon-megan-text">Creaciones artesanales únicas para decorar y regalar.</p>
      </article>
      <article class="box-icon-megan wow fadeInUp" data-wow-delay=".15s">
        <div class="box-icon-megan-header">
          <center>
            <div class="box-icon-megan-icon">
              <i class="bi bi-calendar-check"></i>
            </div>
          </center>
        </div>
        <h5 class="box-icon-megan-title"><a href="#">Reservas</a></h5>
        <p class="box-icon-megan-text">Puedes hacer una cita para consultas y recoger tus pedidos.</p>
      </article>
    </div>
  </div>
</section>

<section class="section section-sm section-first bg-default" id="CrearReserva">
  <div class="container">
    <center>
    <h3 class="heading-3">RESERVAS</h3>
  </center>
    <form class="rd-form rd-mailform form-style-1" data-form-output="form-output-global" data-form-type="contact"
      action="" onsubmit="validateForm()" method="post" id="myForm" enctype="multipart/form-data" >
      {% csrf_token %}
      <div class="row row-20 gutters-20">
        <div class="col-md-6 col-lg-4 oh-desktop">
          <div class="form-wrap wow slideInDown">
            <!-- {{ form.usuario }} -->
            <input type="number" name="usuario" id="" hidden value="{{ request.session.usuario_id }}">
            <input type="text" id="" readonly value="{{ request.session.nombre_usuario }}" class="form-input">
            <!-- <label class="form-label" for="contact-your-name-6">Nombre Usuario</label> -->
          </div>
        </div>
        <div class="col-md-6 col-lg-4 oh-desktop">
          <div class="form-wrap wow slideInUp">
            {{ form.fecha_cita }}
            <label class="form-label" for="contact-email-6"></label>
          </div>
        </div>
        <div class="col-12">
          <div class="form-wrap wow fadeIn">
            <!-- <label class="form-label" for="contact-message-6">Message</label> -->
            {{ form.descripcion }}
          </div>
        </div>
      </div>
      <div class="group-custom-1 group-middle oh-desktop">
        {% if not request.session.usuario_id %}

        <button class="button button-lg button-primary button-winona wow fadeInRight" onclick="window.location.href = '{% url 'usuarios:login' %}';">Primero inicia sesión!!!!!!!</button>

        {% else %}

        <button class="button button-lg button-primary button-winona wow fadeInRight" type="submit">Realizar
          reserva</button>

        {% endif %}
        <!-- Quote Classic-->
        <article class="quote-classic quote-classic-3 wow slideInDown">
          <div class="quote-classic-text">
            <p class="q">Por favor realizar la reserva dos dias despues de la fecha actual hasta dos
              semanas despues
              de la misma.</p>
          </div>
        </article>
      </div>
    </form>
  </div>
</section>


<script src="{% static 'js/core.min.js' %}"></script>
<script src="{% static 'js/script.js' %}"></script>

<style>
.thumbnail-size-1 {
    width: 310px !important;
    height: 585px !important;
    object-fit: cover;
    object-position: center;
}

.thumbnail-size-2 {
    width: 631px !important;
    height: 587px !important;
    object-fit: cover;
    object-position: center;
}

.thumbnail-size-3 {
    width: 311px !important;
    height: 289px !important;
    object-fit: cover;
    object-position: center;
}

.thumbnail-size-4 {
    width: 631px !important;
    height: 289px !important;
    object-fit: cover;
    object-position: center;
}

.thumbnail-size-5 {
    width: 311px !important;
    height: 289px !important;
    object-fit: cover;
    object-position: center;
}

.thumbnail-size-6 {
    width: 311px !important;
    height: 289px !important;
    object-fit: cover;
    object-position: center;
}

.thumbnail-size-7 {
    width: 311px !important;
    height: 289px !important;
    object-fit: cover;
    object-position: center;
}
</style>

<script>
   function validateForm() {
    // Evitar que el formulario se envíe automáticamente
    event.preventDefault();

    // Obtener el formulario de la modal
    const form = document.getElementById('myForm');

    // Obtener el valor de la fecha y hora de la reserva dentro del formulario específico
    const fechaCitaInput = form.querySelector('input[name="fecha_cita"]');
    console.log("Valor del input fecha_cita:", fechaCitaInput.value);

    const fechaCita = new Date(fechaCitaInput.value);
    console.log("Objeto Date creado a partir del input:", fechaCita);

    // Comprobar si la fecha y hora se ha obtenido correctamente
    if (isNaN(fechaCita.getTime())) {
        Swal.fire({
            title: 'Error',
            text: 'Fecha y hora no válidas. Por favor, ingrese una fecha y hora correctas.',
            icon: 'error'
        });
        return;
    }

    // Definir las horas límites
    const horaInicio = 8; // 8:00 AM
    const horaFin = 17; // 5:00 PM

    // Validar la hora de la reserva
    const horaReserva = fechaCita.getHours();
    const minutoReserva = fechaCita.getMinutes();

    // Mostrar los valores de hora y minuto para depuración
    console.log("Hora de la reserva:", horaReserva);
    console.log("Minuto de la reserva:", minutoReserva);

    if (horaReserva < horaInicio || horaReserva >= horaFin || (minutoReserva !== 0 && minutoReserva !== 30)) {
        // Mostrar SweetAlert de error
        Swal.fire({
            title: 'Error',
            text: 'La hora debe estar entre las 8:00 AM y las 5:00 PM, y debe ser en intervalos de media hora (por ejemplo, 8:00, 8:30).',
            icon: 'error'
        });
        return;
    }

    // Crear un objeto FormData para enviar los datos del formulario
    const formData = new FormData(form);

    // Realizar la solicitud POST utilizando fetch
    fetch("{% url 'reservas:crear_reserva' %}", {
        method: 'POST',
        body: formData,
        headers: {
            'X-CSRFToken': '{{ csrf_token }}'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Verificar si la solicitud fue exitosa
        if (data.success) {
            // Mostrar SweetAlert de éxito
            Swal.fire({
                title: '¡Registro exitoso!',
                text: 'La reserva se ha registrado correctamente.',
                icon: 'success',
                onClose: () => {
                    // Recargar la página o realizar alguna otra acción
                    window.location.href = "{% url 'reservas:listar_reserva_cliente' %}";
                }
            }).then(() => {
                window.location.href = "{% url 'reservas:listar_reserva_cliente' %}";
            });
        } else if (data.message) { // Check if a message is provided in the response
            // Mostrar SweetAlert de error con el mensaje recibido
            Swal.fire({
                title: 'Error',
                text: data.message,
                icon: 'error',
            });
        } else if (data.errors) { // Verificar si hay errores de validación
            let errorMessage = "Hubo un error al procesar su solicitud:<br>";
            for (const key in data.errors) {
                errorMessage += `${data.errors[key]}<br>`;
            }
            // Mostrar SweetAlert de error con los errores de validación
            Swal.fire({
                title: 'Error',
                html: errorMessage,
                icon: 'error',
            });
        } else { // If no message is provided, show a generic error message
            // Mostrar SweetAlert de error genérico
            Swal.fire({
                title: 'Error',
                text: 'Hubo un error al procesar su solicitud. Por favor, revise los campos e inténtelo de nuevo.',
                icon: 'error'
            });
        }
    })
    .catch(errors => {
        // Mostrar SweetAlert de error en caso de un fallo en la solicitud
        Swal.fire({
            title: 'Error',
            text: 'Hubo un error al procesar su solicitud. Por favor, inténtelo de nuevo más tarde.',
            icon: 'error'
        });
        console.error('Error:', errors);
    });
}

</script>
{% endblock %}